> [!note]
> я не завидую тому, кто здесь будет разбираться, говнокод писался в спешке)

---

## Основное

Используется yarn в качестве менеджера библиотек, `yarn dev` для запуска тестового сайта, `yarn build` чтобы сбилдить сайт - index.html будет в dist/, достаточно захостить его (например используя vercel, там ваще легко сайт развернуть)

Идея для запуска кода, что пишет пользователь на C, следующая: 
1. При инициализации создаётся виртуальная файловая система, в ней используется компилятор clang и линкер lld
2. При запуске кода, он компилируется и линкуется на WASM такими же командами, что и на обычной ОС
3. Полученная программа на WASM сразу запускается, при этом имеет доступ к некоторым определённым функциям в JS

Сайт делится на 3 потока: основной, воркер с симуляцией физики и воркер с компилированием и запуском C кода пользователя. Для UI используется React, для управления глобальным состоянием сайта (текущий код, загрузка, скорость) - zustand, для физики - [matter.js](https://brm.io/matter-js/docs/)~~, для C - украденный код~~

Поскольку данные о состоянии машинки в симуляции нельзя напрямую брать из потока C, для обмена состоянием симуляции используется общий буфер данных, включающий в себя время в симулации, значение УЗ датчика, датчиков линий, акселерометра и гироскопа. 

1 метр - 5000 пикселей. Не спрашивайте про остальные единицы измерения.. 
### Структура:

- public/ - ресурсы сайта, включая файловую систему, библиотеки на C, изображения с машинкой, датчиками и полем:
	- Omega.h, Omega.c - основная библиотека
- src/:
	- store.js - инициализация store, дефолтные значения кода, функции инициализации воркеров
	- main.js - пути на сайте, их задача для путей айди соответствующих задач
	- App.js - основной UI, его логика
	- components/ - компоненты, *duh*
	- physics/: - симуляция
		- worker.js - инициализация воркера, функции для связи с другими потоками, а также для обновления значений в буфере, обработка сообщений от других потоков
		- utils.js - утилиты для работы с matter.js (см. комментарии)
		- main.js - инициализация симуляции: скачивание нужных картинок, расположение на поле нужных картинок в зависимости от id задачи, машинки, инициализация сенсоров на машинке, обновление значений в буфере каждый тик. Также рендеринг тел на canvas'е
		- tick.js - применение сил на машинку в зависимости от значений шим на моторах
		- sensors/ - датчики. сами разберётесь :D
	- compiler/: - компиляция, запуск пользовательского кода C
		- worker.js - инициализация воркера, функции для связи с другими потоками, а также для чтения значений в буфере, обработка сообщений от других потоков

---
### Если используете этот код в своих целях
то пожалуйста, укажите меня в авторах <3
